\section{Evaluation}
\label{sec-evaluation}

We evaluate PocketParker in three ways. First, we conducted a controlled
experiment to determine the correct parameter settings for our parking event
detector. Second, we have implemented a parking lot simulator, which allows
us to experiment with various kinds of lots as well as vary the monitored
fraction and other parameters. Finally, we performed a small-scale deployment
of PocketParker on our campus and use it to monitor three lots. Camera
monitoring was used to ground truth the predictions from our deployment
dataset. All three components of our evaluation together confirm that
PocketParker is efficiency and accurate.

\subsection{Detector Experiment}

\begin{figure}
\centering
\includegraphics[width=3.325in]{./figures/Energy_accuracy.pdf}

\caption{\textbf{Power usage vs. detector accuracy.} Energy usage by
PocketParker is low at all duty cycles, so we chose an aggresive duty cycle
in order to improve detection accuracy.}

\label{fig-energy}
\end{figure}

\input{./figures/experiment_table/table.tex}

To determine the right parameter settings for our transition detector, we
conducted a controlled experiment. During this experiment, accelerometer and
GPS data was collected continuously and store on each device, and
participants were asked to manually label each transition into and out of the
car. Afterwards, data was fed into Python-based simulator implementing the
same algorithm used by the PocketParker application, allowing us measure
accuracy and energy consumption as function of the detector duty cycle.

Eight volunteers participated, including seven men and one woman, seven of
whom were right-handed and one of whom was left-handed. Each was asked to
conduct the same experiment 10 times: carrying the instrumented phone, walk
out to their car, label departure, drive around briefly, park, label arrival,
and walk back inside. Since the way the phone is carried while walking and
placed in the car while driving affects the accelerometer readings, care was
taken to generate a good mix of carry and car location styles.
Table~\ref{table-experiment} shows the breakdown. The experiment permitted us
to obtain sensing data from a cross section of people posessed of varying
body morphologies and different habits of driving cars and handling mobile
devices. Participation in the experiment took roughly one hour and pizza was
provided.

Figure~\ref{fig-energy} displays the tradeoff between energy usage and
detection accuracy as a function of the PocketParker duty cycle. Here we
combine an active period of 5~s with a inactive period of variable length,
between 5~and~55~s, for an overall duty cycle between 0.5 and 0.06. Our
simulator uses energy numbers used by the Android Fuel Guage application
along with the acceloremeter duty cycles and number of GPS locations
requested including false positives to estimate average power consumption.
This graph measures the accuracy of detected events in terms of distance from
the actual location of the event labelled by the participant

As we expect, longer duty cycles consume less energy but produce longer
detection latencies which translate into higher distances from the event
location. Note also that the departure events have higher location error than
the parking events, simply because after departing users are driving and
therefore traveling more rapidly. Overall power usage by PocketParker is low,
under 10~mW at all duty cycles. Because PocketParker's ability to map parking
events into lots is affected by the detection distance accuracy, we chose a
relatively-aggresive total period of 15~s for a $\frac{1}{3}$ duty cycle.
This allows PocketParker to determine location to within 25~m for parking
events and 80~m for departures. Power consumption at this duty cycle is 8~mW,
representing 4.2\% of a the capacity of a 1500~mAh battery discharged over
24~hours if used continuously.

\begin{figure*}
\centering
\includegraphics[width=\textwidth]{./simulator/figures/lots.pdf}

\caption{\textbf{Description of each type of lot simulated.} Five different
lots with different behaviors were used during simulations.}

\label{fig-lotsdescription}
\end{figure*}

\subsection{Simulation Results}
\label{subsec-simulator}

To experiment with PocketParker in a more controlled setting, we implemented
a parking lot simulator in Python. Our simulator allows us to simulate any
number of parking lots associated with any number of points of interest with
varying desirability levels. For simplicity during our evaluation, we
simulate two lots 1~and~2 with lot~1 filling before lot~2, although lot
choice by simulated drivers is probabilisticly weighted. Particularly for
evaluating our monitored fraction estimation we are interested in lots that
fill and empty in various ways. We use five types of lots:

\begin{itemize}

\item \textbf{Fast Fill} and \textbf{Slow Fill} fill once per day quickly or
slowly, like a lot associated with a place of work.

\item \textbf{High Churn} starts with lot~1 full and experiences continuously
high arrival and departures rates, like an airport parking lot.

\item \textbf{Low Churn} represents underutilized lots that never completely
fill, with lot~2 almost completely unused.

\item \textbf{Multiple Fill} represents a lot that rapidly fills and empties
repeatedly during each day, perhaps like a campus lot or movie theater.

\end{itemize}

Figure~\ref{fig-description} shows the arrival and departure rates for each
of the types of lot as well as the resulting overall capacity.

\begin{figure*}
\centering
\includegraphics[width=\textwidth]{./simulator/figures/capacity_experiment.pdf}

\caption{\textbf{Errors in capacity estimation.} \XXXnote{GWA: TODO.}}

\label{fig-capacityerrors}
\end{figure*}

\subsubsection{Monitored fraction estimation}

In Section~\ref{subsubsec-monitored} we describe our approach to estimated
the monitored fraction, a parameter important to the operation of the
PocketParker availability estimator. Figure~\ref{fig-capacityerrors} shows
the results of 10 random simulations for each lot type. In each case, the
monitored fraction estimator uses a weeks worth of data and proceeds as
described previously. The error in the monitored fraction estimate is shown
as a function of the actual monitored fraction for the simulation used,
although that is unknown.

For the five types of lots, we would expect PocketParker to do better
monitored fraction estimation when lots fill regularly---Fast Fill, Slow
Fill, and Multiple Fill---and poorly when they do fill erratically or not at
all---High and Low Churn. \XXXnote{GWA: Finish when results look better.}

In addition, because lot~1 in our simulations fills
first and lot~2 sometimes does not fill at all, we would expect to do a
better job with lot~1. \XXXnote{GWA: Finish when results look better.}

\begin{figure}
\centering
\includegraphics[width=3.325in]{./simulator/figures/tracking_fastfill.pdf}

\caption{\textbf{Availability probabilities tracking lot capacity.} Dips in
the availability probability correspond to times when PocketParker believes
the lot is full. Discontinuities are caused by departures, which set the
instantaneous probability that the lot is available to 1.0.}

\label{fig-trackingexample}
\end{figure}

\subsubsection{Probability and availability}

At this point we take a closer look at the way that PocketParker adjusts lot
availability probabilities. Keep in mind that that the absolute value of the
availability probability for each lot may not meaningful. Instead,
PocketParker uses the probabilites to order available lots in response to
queries. We examine its accuracy at performing this essential task next.
However, it is illustrative to examine the probabilities PocketParker
maintains and compare them against ground truth: the actual number of spots
in the lot.

Figure~\ref{fig-trackingexample} shows a 24~hour simulation of a Fast Fill
parking lot with a monitored fraction of 0.1 and a 10\% error in the
estimation of the monitored fraction. The ground truth capacity of the lot as
simulated is plotted next to the PocketParker probability that the lot has an
available spot. At the beginning of the simulation, both lots are marked as
free. When lot~1 fills and lot~2 begins to fill, generating implicit searches
in lot~1, the availability probability of lot~1 drops. It bumps upward
repeatedly due to departures from lot~1, but does not equal the probability
for lot~2 again until the point when the departure rate for lot~1 climbs and
both lots begin to empty.

\subsection{Deployment}

Finally, to establish the accuracy of PocketParker we performed a small-scale
deployment on campus. Five participants installed our PocketParker
application and generated 372 events over ten days---202 arrivals and 170
departures. Of those events, 127 occurred near campus including false
positives, and 56 were mapped into the three campus lots monitored by
PocketParker. One of the participants lives quite close to campus, and many
of the parking transitions that occurred at their house were included in the
127~events near campus. The deployment period included several days when
participants did not come to campus, and most parking events were generated
by three participants who came to campus daily. Figure~\ref{fig-events} shows
all of the events that occurred in the three lots we monitored. Our computer
science department is labeled as the point of interest.

Of the participants that installed PocketParker, none complained of excessive
energy usage or battery life problems. While the PocketParker interface
displays the last sensed state, no interaction with the application was
required or recorded.

\begin{figure*}
\centering
\includegraphics[width=\textwidth,height=2in]{./figures/detectedEventsOnMap.pdf}

\caption{\textbf{Map showing all events detected by PocketParker during our
ten-day deployment.} 56~events are shown in three monitored lots.}

\label{fig-events}
\end{figure*}

\begin{figure}
\centering
\includegraphics[width=3.0in]{./figures/Camera_setting.pdf}

\caption{\textbf{Monitoring cameras.} A view of one of the monitored parking
lots is shown.}

\label{fig-camera}
\end{figure}
